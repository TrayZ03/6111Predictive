"0",""
"0","roc_data <- data.frame(threshold=seq(1,0,-0.01), fpr=0, tpr=0)"
"0","for (i in roc_data$threshold) {"
"0","  over_threshold <- knn_test_results[knn_test_results$.pred_Attrited.Customer >= i, ]"
"0","  "
"0","  pred_neg <- sum(over_threshold$Attrition_Flag==""Existing Customer"")"
"0","  pred_pos <- sum(over_threshold$Attrition_Flag==""Attrited Customer"")"
"0","  "
"0","  true_neg <- sum(knn_test_results$Attrition_Flag==""Existing Customer"")"
"0","  true_pos <- sum(knn_test_results$Attrition_Flag==""Attrited Customer"")"
"0","  "
"0","  fpr <- pred_neg/true_neg"
"0","  roc_data[roc_data$threshold==i, ""fpr""] <- fpr"
"0","  "
"0","  tpr <- pred_pos/true_pos"
"0","  roc_data[roc_data$threshold==i, ""tpr""] <- tpr"
"0","  "
"0","}"
"0",""
"0","ggplot() +"
"0","  geom_line(data = roc_data, aes(x = fpr, y = tpr, color = threshold), linewidth = 2) +"
"0","  scale_color_gradientn(colors = rainbow(3)) +"
"0","  geom_abline(intercept = 0, slope = 1, lty = 2) +"
"0","  geom_point(data = roc_data[seq(1, 101, 10), ], aes(x = fpr, y = tpr)) +"
"0","  geom_text(data = roc_data[seq(1, 101, 10), ],"
"0","            aes(x = fpr, y = tpr, label = threshold, hjust = 1.2, vjust = -0.2))"
